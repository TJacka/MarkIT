<%- include('partials/headerauthin') -%>

<div class="container card-container">
  <div class="flex"> 
    <div class="justify-content-between details-container">
      <div class="flex col-3 swipe-title">
        <h1 class="mb-3" style="font-weight: 800; font-size: 2rem;"><%= swipe.title %></h1>
        <div class="d-flex justify-content-between" style="width: 10rem;">
          <div class="badge bg-success" style="width: 4rem; height: 25px; padding-top: 6px; text-align: left;margin-right: 8px";>Likes: <%= swipe.likes.length - 1 %></div>
          <p>By: <%= swipe.userName %></p>
        </div>
      </div>
      <p class="swipe-details-sub" style="font-weight: 500; font-size: 1.3rem;"><%= swipe.caption %></p>
      <div class="col-3 btn-social">
        <div class="d-flex mt-1">
          <form style="margin-left: auto;" action="/swipe/likeSwipe/<%= swipe.id %>?_method=PUT" method="POST">
            <button class="btn mx-1" id="btn-signup" title="Like Swipe" style="font-size: 1.2rem; font-family: 'Open Sans', sans-serif;" type="submit"><i class="<%if(swipe.likes.includes(user.id)){ %> bi bi-hand-thumbs-up-fill <%} else { %> bi bi-hand-thumbs-up <% }%>" style="font-style: normal; font-weight: 500;"></i></button>
          </form>
          <form class="" action="/swipe/favSwipe/<%= swipe.id %>?_method=PUT" method="POST">
            <button class="btn mx-1" id="btn-signup" title="Add to Favorites" style="font-size: 1.2rem;" type="submit"><i class="<%if(swipe.favorites.includes(user.id)){ %> bi bi-star-fill <%} else { %> bi bi-star <% }%>"></i></button>
          </form>   
          <%if(swipe.userName == user.userName){ %>
          <form action="/swipe/deleteSwipe/<%= swipe.id %>?_method=DELETE" method="POST" class="col-3">
            <button class="btn btn-danger mx-1" type="submit" title="Delete Swipe" style="font-size: 1.2rem; padding-top: 7px; padding-bottom: 5px;"><i class="bi bi-trash"></i></button>
          </form>
          <%}%>
        </div>
      </div>
    </div>
    <div class="flex mx-auto swipe-img-holder" style="box-shadow: 0 0 50px rgb(184, 183, 183); border-radius: 8px; border: 1px solid silver; width: max-content; padding: 1rem; max-width: 700px;">
      <img src="<%= swipe.image%>" style="object-fit: fill; max-height: 600px; border-radius: 5px;" class="swipe-img mx-auto" alt="Responsive image">
    </div>
    <div class="mt-5 commentbox mx-auto">
      <h2>Add a comment</h2>
      <form action="/comment/createComment/<%=swipe._id%>" method="POST">
        <div class="mb-3">
            <label for="title" class="form-label">Comment</label>
            <input type="text" class="form-control" id="comment" name="comment">
        </div>
        <button type="submit" id="btn-loginpage" class="btn" >Submit</button>
      </form>
    </div>
    <div style="margin-top: 40px;">
      <ul style="padding-left: 0;">
        <% for(var i=0; i<comments.length; i++) {%>
          <li class="col-6 justify-content-between mt-4" style="list-style: none; margin: 0 auto; border-radius: 5px;">
            <div class="list-group-item d-flex gap-3 py-3">
              <i class="bi bi-person-circle"></i>
              <div class="d-flex gap-2 w-100 justify-content-between">
                <div>
                  <p class="mb-0 opacity-75"><%= comments[i].comment%></p>
                </div>
                <small class="badge opacity-50" style="padding-top: 6px; background: rgb(238, 180, 168); color: black;"><%= new Date().getDate(); %> / <%= new Date().getMonth(); %> / <%= new Date().getFullYear(); %></small>
              </div>
            </div>
          </li>
        <% } %>
      </ul>
    </div>
  </div>
</div>

<%- include('partials/footer') -%>